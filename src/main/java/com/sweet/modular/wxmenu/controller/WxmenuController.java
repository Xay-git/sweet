package com.sweet.modular.wxmenu.controller;import com.soecode.wxtools.api.WxConfig;import com.sweet.core.translationDict.DictParam;import com.sweet.core.translationDict.TranslationDict;import org.springframework.web.bind.annotation.RequestBody;import org.springframework.web.bind.annotation.RequestMapping;import com.sweet.core.model.ResultBean;import com.sweet.core.model.system.LayuiPageInfo;import com.sweet.modular.wxmenu.entity.Wxmenu;import com.sweet.modular.wxmenu.service.WxmenuService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.RequestMapping;import com.sweet.core.util.StringUtil;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.ResponseBody;import org.springframework.stereotype.Controller;import java.util.List;/** * <p> * 微信菜单 前端控制器 * </p> * * @author admin * @since 2020-01-08 */@Controller@RequestMapping("/admin/wxmenu")public class WxmenuController {    @Autowired    WxmenuService wxmenuService;    String appId = WxConfig.getInstance().getAppId();    /**     * 列表页     */    @RequestMapping("/wxmenu_list")    public String list(){        return "/modular/wxmenu/wxmenu_list";    }    /**     * 编辑页     */    @RequestMapping("/wxmenu_edit")    public String edit(){        return "/modular/wxmenu/wxmenu_edit";    }    /**     * 添加/编辑     */    @RequestMapping("/editWxmenu")    @ResponseBody    public ResultBean editWxmenu(@RequestBody Wxmenu wxmenu){        if ((wxmenu.getTier().intValue() == 1)) {            wxmenu.setParentId(appId);        }else{            wxmenu.setParentId(appId+","+wxmenu.getParentId());        }        wxmenuService.saveOrUpdate(wxmenu);        return ResultBean.success(wxmenu);    }    /**     * 删除     */    @RequestMapping("/delWxmenu")    @ResponseBody    public ResultBean delWxmenu(Wxmenu wxmenu){        wxmenuService.removeById(wxmenu);        return ResultBean.success(wxmenu);    }    /**     * 添加修改菜单     * @param menu     * @return     */    @RequestMapping("/getWxmenuDetail")    @ResponseBody    public ResultBean getWxmenuDetail(String buttonId){        List<Wxmenu> list = wxmenuService.getMenuByAppId(appId);        return ResultBean.success(list);    }    @RequestMapping("/saveButton")    @ResponseBody    public ResultBean saveButton(@RequestBody List<Wxmenu> wxmenu){        wxmenu.stream().forEach(button -> {            wxmenuService.updateById(button);            if(button.getSub_button()!=null){                button.getSub_button().stream().forEach(sub->{                    wxmenuService.updateById(sub);                });            }        });        return ResultBean.success(wxmenu);    }    /**     * 列表数据     */    @RequestMapping("/getWxmenuList")    @ResponseBody    @TranslationDict({    })    public LayuiPageInfo getWxmenuList(Wxmenu Wxmenu){        LayuiPageInfo pageInfo = wxmenuService.findPageBySpec(Wxmenu);        return pageInfo;    }}