<%layout("/common/_container.html"){%><div class="layui-fluid" id="app" style="background: #fff;min-height:calc(100% - 10px)">    <form id="userFrom" lay-filter="userFrom" class="layui-form model-form">        <input name="userId" type="hidden" value="${parameter.userId}"/>        <div class="layui-form-item">            <label class="layui-form-label">用户名</label>            <div class="layui-input-block">                <input name="userName" placeholder="用户名" type="text" class="layui-input" maxlength="50"                       lay-verType="tips" lay-verify="required" required/>            </div>        </div>        <div class="layui-form-item">            <label class="layui-form-label">账号类型</label>            <div class="layui-input-block">                <input name="accountStatus" type="radio" value="1" title="正常" checked/>                <input name="accountStatus" type="radio" value="0" title="锁定" />            </div>        </div>        <div class="layui-form-item">            <label class="layui-form-label">出生日期</label>            <div class="layui-input-block">                <input id="birthday" readonly name="birthday" placeholder="请选择" type="text" class="layui-input"/>            </div>        </div>        <div class="layui-form-item">            <label class="layui-form-label">所属部门</label>            <div class="layui-input-block">                <select name="deptId" lay-search>                    <option value="">请选择上级菜单</option>                    <option v-for="item in dept" :value="item.deptId" v-if="app.isEmpty(deptId)">{{item.deptName}}</option>                    <option v-for="item in dept" :value="item.deptId" :selected="deptId==item.deptId" v-if="!app.isEmpty(deptId)">{{item.deptName}}</option>                </select>            </div>        </div>        <div class="layui-form-item">            <label class="layui-form-label">角色分配</label>            <div class="layui-input-block">                <div id="roleAssign"></div>            </div>        </div>        <div class="layui-form-item text-right" style="margin-top:180px;">            <button class="layui-btn layui-btn-primary" type="button" ew-event="closeDialog">取消</button>            <button class="layui-btn" lay-filter="userFrom" lay-submit>保存</button>        </div>    </form></div><script>    var form = layui.form;    var vm = new Vue({        el: '#app',        data: {            msg: 'Hello World!',            deptId:'${parameter.deptId}',            info:'',            dept:''        },        methods: {        },        mounted:async function() {            vm = this;            vm.dept = await api.getDeptList();            laydate.render({                elem: '#birthday'            });            var userRoleIds = [];            var userId = '${parameter.userId}';            if(!app.isEmpty(userId)){                vm.info = await api.getUserDetail(userId);                form.val('userFrom', vm.info);                userRoleIds = await api.getUserRole(userId);            }            form.on('submit(userFrom)', function (data) {                api.addUser(data.field).then(res=>{                    //传给上个页面，刷新table用                    admin.putTempData('formOk', true);                    //关掉对话框                    admin.closeThisDialog();                });                return false;            });            var XmSelectData = await api.getRoleXmSelect();            layui.use(['xmSelect'], function(){                var roleAssign = xmSelect.render({                    el: '#roleAssign',                    initValue: userRoleIds,                    data: XmSelectData,                    name: 'roleAssign',                    layVerify: 'required',                    layVerType: 'tips',                })            });            admin.iframeAuto();            form.render();        },        updated: function () {            form.render();        }    })</script><% } %>